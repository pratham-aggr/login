<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scout Login</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }

    body {
        background-color: #f5f7fa;
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
        background-image: url('/api/placeholder/1200/800');
        background-size: cover;
        background-position: center;
        position: relative;
    }

    body::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 1;
    }

    .login-container {
        background-color: white;
        border-radius: 10px;
        box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        width: 90%;
        max-width: 400px;
        padding: 40px;
        position: relative;
        z-index: 2;
    }

    .login-header {
        text-align: center;
        margin-bottom: 30px;
    }

    .logo {
        width: 80px;
        height: 80px;
        background-color: #3f51b5;
        border-radius: 50%;
        margin: 0 auto 15px;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .logo svg {
        width: 50px;
        height: 50px;
        fill: white;
    }

    h1 {
        font-size: 24px;
        color: #333;
        margin-bottom: 8px;
    }

    p.subtitle {
        color: #666;
        font-size: 14px;
        margin-bottom: 30px;
    }

    .form-group {
        margin-bottom: 20px;
    }

    label {
        display: block;
        margin-bottom: 8px;
        color: #333;
        font-size: 14px;
        font-weight: 500;
    }

    input {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid #ddd;
        border-radius: 5px;
        font-size: 14px;
        transition: border-color 0.3s;
    }

    input:focus {
        border-color: #3f51b5;
        outline: none;
    }

    .forgot-password {
        text-align: right;
        margin-bottom: 20px;
    }
    Ë™
    .forgot-password a {
        color: #3f51b5;
        font-size: 13px;
        text-decoration: none;
    }

    .login-btn {
        background-color: #3f51b5;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 12px 0;
        width: 100%;
        font-size: 16
        font-weight: 500;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .login-btn:hover {
        background-color: #303f9f;
    }

    .divider {
        display: flex;
        align-items: center;
        margin: 25px 0;
    }

    .divider::before, .divider::after {
        content: "";
        flex: 1;
        border-bottom: 1px solid #ddd;
    }

    .divider-text {
        padding: 0 10px;
        color: #666;
        font-size: 14px;
    }

    .google-btn {
        display: flex;
        justify-content: center;
        margin-bottom: 20px;
    }

    .register-link {
        text-align: center;
        margin-top: 20px;
        font-size: 14px;
    }

    .register-link a {
        color: #3f51b5;
        text-decoration: none;
        font-weight: 500;
    }

    #user-info {
        display: none;
        text-align: center;
        padding: 20px 0;
    }

    #user-info img {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        margin-bottom: 10px;
    }

    #logout-btn {
        background-color: #f44336;
        color: white;
        border: none;
        border-radius: 5px;
        padding: 10px 15px;
        font-size: 14px;
        cursor: pointer;
        margin-top: 15px;
        transition: background-color 0.3s;
    }

    #logout-btn:hover {
        background-color: #d32f2f;
    }

    .success-message {
        background-color: #4CAF50;
        color: white;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
        text-align: center;
        display: none;
    }
    </style>
</head>
<body>
    <div class="login-container">
        <div class="login-header">
            <div class="logo">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm4.59-12.42L10 14.17l-2.59-2.58L6 13l4 4 8-8z"/>
                </svg>
            </div>
            <h1>Scout Login</h1>
            <p class="subtitle">Log in to access your Scout dashboard</p>
        </div>
        
        <div class="success-message" id="success-message">
            Login successful! Redirecting to dashboard...
        </div>
        
        <div id="login-form">
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" placeholder="Enter your email">
            </div>
            
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" placeholder="Enter your password">
            </div>
            
            <div class="forgot-password">
                <a href="#">Forgot password?</a>
            </div>
            
            <button class="login-btn">Login</button>
            
            <div class="divider">
                <span class="divider-text">or</span>
            </div>
            
            <div class="google-btn">
                <div id="g_id_onload"
                    data-client_id="509175230405-m0t3p8pijr6sv7b4u7lih6ss06sjiv6q.apps.googleusercontent.com"
                    data-context="signin"
                    data-callback="handleCredentialResponse">
                </div>
                <div class="g_id_signin"
                    data-type="standard"
                    data-size="large"
                    data-theme="outline"
                    data-text="sign_in_with"
                    data-shape="rectangular"
                    data-logo_alignment="center">
                </div>
            </div>
            
            <div class="register-link">
                Don't have an account? <a href="#">Register</a>
            </div>
        </div>
        
        <div id="user-info">
            <img id="user-image" src="/api/placeholder/60/60" alt="User Profile">
            <h3 id="user-name">User Name</h3>
            <p id="user-email">user@example.com</p>
            <button id="logout-btn">Logout</button>
        </div>
    </div>
    <script>
               // Function to handle Google Sign-In credential response
    function handleCredentialResponse(response) {
    const responsePayload = parseJwt(response.credential);

    document.getElementById('user-image').src = responsePayload.picture;
    document.getElementById('user-name').textContent = responsePayload.name;
    document.getElementById('user-email').textContent = responsePayload.email;
    document.getElementById('login-form').style.display = 'none';
    document.getElementById('user-info').style.display = 'block';
    document.getElementById('success-message').style.display = 'block';

    sessionStorage.setItem('user', JSON.stringify({
        name: responsePayload.name,
        email: responsePayload.email,
        picture: responsePayload.picture
    }));

    const sheetUrl = 'https://opensheet.elk.sh/1AbCDeFgHIJklMnOPqrStUvWxYZ1234567/Sheet1';

    fetch(sheetUrl)
        .then(res => res.json())
        .then(data => {
        const leaderEmails = data.map(row => row.email.toLowerCase());
        const userEmail = responsePayload.email.toLowerCase();

        const redirectUrl = leaderEmails.includes(userEmail)
            ? "https://sites.google.com/view/swefiehorthodoxscout/leader-portal"
            : "https://sites.google.com/view/swefiehorthodoxscout/member-portal";

        setTimeout(() => {
            const emailLower = email.toLowerCase();
            if (emailLower === "prathamaggarwal7586@gmail.com") {
                window.location.href = "https://sites.google.com/view/swefiehorthodoxscout/leader-portal";
            } else if (emailLower === "fzbatshon@ucsd.edu") {
                window.location.href = "https://sites.google.com/view/swefiehorthodoxscout/member-portal";
            } else {
                alert("Email not recognized. Access denied.");
                document.getElementById('success-message').style.display = 'none';
                document.getElementById('login-form').style.display = 'block';
            }
        }, 2000);

    }

        
        // Function to parse JWT token
        function parseJwt(token) {
            const base64Url = token.split('.')[1];
            const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
            const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
                return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
            }).join(''));
            
            return JSON.parse(jsonPayload);
        }
        
        // Check if user is already logged in
        document.addEventListener('DOMContentLoaded', () => {
            const storedUser = sessionStorage.getItem('user');
            
            if (storedUser) {
                const user = JSON.parse(storedUser);
                document.getElementById('user-image').src = user.picture;
                document.getElementById('user-name').textContent = user.name;
                document.getElementById('user-email').textContent = user.email;
                
                document.getElementById('login-form').style.display = 'none';
                document.getElementById('user-info').style.display = 'block';
            }
            
            // Regular login button click handler
            document.querySelector('.login-btn').addEventListener('click', () => {
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                
                if (email && password) {
                    document.getElementById('success-message').style.display = 'block';
                    document.getElementById('login-form').style.display = 'none';
                    
                    // Simulate a user login (in a real app, this would verify credentials with a server)
                    setTimeout(() => {
                        alert("In a real application, credentials would be verified with your server.");
                        window.location.href = "https://sites.google.com/view/swefiehorthodoxscout/your-porta;
                    }, 2000);
                } else {
                    alert("Please enter both email and password.");
                }
            });
            
            // Logout button click handler
            document.getElementById('logout-btn').addEventListener('click', () => {
                // Clear session storage
                sessionStorage.removeItem('user');
                
                // Hide user info and show login form
                document.getElementById('user-info').style.display = 'none';
                document.getElementById('login-form').style.display = 'block';
                document.getElementById('success-message').style.display = 'none';
                
                // Clear form fields
                document.getElementById('email').value = '';
                document.getElementById('password').value = '';
                
                // Sign out from Google
                google.accounts.id.disableAutoSelect();
            });
        });
    </script>
</body>
</html>